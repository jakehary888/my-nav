<script>
    const { createApp, ref, onMounted, computed } = Vue;

    createApp({
        setup() {
            const searchQuery = ref('');
            const navData = ref([]); // 初始数据为空

            // 核心功能：从 data.json 读取数据
            onMounted(async () => {
                try {
                    const response = await fetch('data.json');
                    navData.value = await response.json();
                } catch (e) {
                    console.error("加载数据失败，请检查 data.json 格式", e);
                }
            });

            const categories = computed(() => navData.value.map(c => c.name));

            const filteredNav = computed(() => {
                if (!searchQuery.value) return navData.value;
                return navData.value.map(cat => ({
                    ...cat,
                    items: cat.items.filter(item => 
                        item.title.toLowerCase().includes(searchQuery.value.toLowerCase()) || 
                        item.desc.toLowerCase().includes(searchQuery.value.toLowerCase())
                    )
                })).filter(cat => cat.items.length > 0);
            });

            const scrollTo = (id) => {
                const el = document.getElementById(id);
                if(el) el.scrollIntoView({ behavior: 'smooth' });
            };

            return { navData, categories, searchQuery, filteredNav, scrollTo };
        }
    }).mount('#app');
</script>
